{"version":3,"sources":["ng://signalk-client-angular/lib/uuid.ts","ng://signalk-client-angular/lib/utils.ts","ng://signalk-client-angular/lib/http-api.ts","ng://signalk-client-angular/lib/stream-api.ts","ng://signalk-client-angular/lib/apps-api.ts","ng://signalk-client-angular/lib/signalk-client.ts","ng://signalk-client-angular/lib/signalk-client.module.ts"],"names":["UUID","this","limitUI04","maxFromBits","limitUI06","limitUI08","limitUI12","limitUI14","limitUI16","limitUI32","limitUI40","limitUI48","create","prototype","toString","hex","toURN","toSignalK","toBytes","parts","split","ints","intPos","i","length","j","parseInt","substr","bits","Math","pow","getRandomInt","min","max","floor","random","randomUI04","randomUI06","randomUI08","randomUI12","randomUI14","randomUI16","randomUI32","randomUI40","randomUI48","fromParts","paddedString","string","z","String","timeLow","timeMid","timeHiAndVersion","clockSeqHiAndReserved","clockSeqLow","node","version","Path","dotToSlash","path","p","indexOf","join","contextToPath","context","Message","updates","subscribe","unsubscribe","request","requestId","Alarm","message","state","visual","sound","_method","_message","_state","AlarmState","alarm","push","AlarmMethod","Object","defineProperty","method","normal","alert","warn","emergency","SignalKHttp","http","val","_token","getSelf","get","getSelfId","getMeta","endpoint","slice","url","headers","HttpHeaders","Authorization","put","c","k","v","msg","value","t","r","server","id","v_1","JSON","parse","stringify","post","delete","Injectable","args","providedIn","HttpClient","SignalKStream","_filter","_wsTimeout","_playbackMode","_source","_connect","Subject","onConnect","asObservable","_close","onClose","_error","onError","onMessage","ws","readyState","selfId","close","open","token","_this","q","WebSocket","setTimeout","console","onopen","e","next","onclose","onerror","onmessage","parseOnMessage","data","isHello","self","startTime","isResponse","login","isDelta","sendRequest","keys","forEach","send","username","password","sendUpdate","uValues","Array","isArray","u","timestamp","Date","toISOString","values","options","sValue","raiseAlarm","alarmId","n","clearAlarm","name","isSelf","SignalKApps","ngOnDestroy","list","ep","USER","GLOBAL","SignalKClient","apps","api","stream","_version","fallbackEndpoints","endpoints","v1","info","apiVersions","fallback","init","debug","isDevMode","log","authToken","hostname","port","useSSL","protocol","hello","connectAsPromise","Promise","resolve","reject","response","getLoginStatus","processHello","resolveHttpEndpoint","resolveStreamEndpoint","error","disconnectedFromServer","connect","sub","disconnect","connectStreamAsPromise","then","Error","catch","connectStream","connectPlaybackAsPromise","openPlayback","connectPlayback","openStream","replace","pb","playbackRate","resolveAppsEndpoint","set","logout","responseType","isLoggedIn","status","snapshot","time","resolveAppDataEndpoint","appId","setAppId","_appId","setAppVersion","_appVersion","appDataVersions","APPDATA_CONTEXT","appDataKeys","appDataGet","appDataSet","appDataPatch","SignalKClientModule","NgModule","imports","HttpClientModule","declarations","exports","entryComponents","providers","mob","fire","sinking","flooding","collision","grounding","listing","adrift","piracy","abandon"],"mappings":"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","sourcesContent":["/*\r\n * UUID: A js library to generate and parse UUIDs, TimeUUIDs and generate\r\n * TimeUUID based on dates for range selections.\r\n * @see http://www.ietf.org/rfc/rfc4122.txt\r\n **/\r\nexport class UUID {\r\n\r\n    private limitUI04;\r\n    private limitUI06;\r\n    private limitUI08;\r\n    private limitUI12;\r\n    private limitUI14;\r\n    private limitUI16;\r\n    private limitUI32;\r\n    private limitUI40;\r\n    private limitUI48;\r\n\r\n    private version:number;\r\n    private hex:string;\r\n\r\n    constructor() {\r\n        this.limitUI04 = this.maxFromBits(4);\r\n        this.limitUI06 = this.maxFromBits(6);\r\n        this.limitUI08 = this.maxFromBits(8);\r\n        this.limitUI12 = this.maxFromBits(12);\r\n        this.limitUI14 = this.maxFromBits(14);\r\n        this.limitUI16 = this.maxFromBits(16);\r\n        this.limitUI32 = this.maxFromBits(32);\r\n        this.limitUI40 = this.maxFromBits(40);\r\n        this.limitUI48 = this.maxFromBits(48); \r\n\r\n        this.create();\r\n    }\r\n\r\n    toString() { return this.hex }\r\n    toURN() { return 'urn:uuid:' + this.hex }\r\n    toSignalK():string  { return `urn:mrn:signalk:uuid:${this.hex}` }\r\n    toBytes() {\r\n        let parts = this.hex.split('-');\r\n        let ints = [];\r\n        let intPos = 0;\r\n        for (let i = 0; i < parts.length; i++) {\r\n            for (let j = 0; j < parts[i].length; j+=2) {\r\n            ints[intPos++] = parseInt(parts[i].substr(j, 2), 16);\r\n            }\r\n        }\r\n        return ints;\r\n    };    \r\n\r\n    private maxFromBits(bits) { return Math.pow(2, bits) };\r\n\r\n    private getRandomInt(min, max) { return Math.floor(Math.random() * (max - min + 1)) + min }\r\n\r\n    private randomUI04() { return this.getRandomInt(0, this.limitUI04-1) }\r\n    private randomUI06() { return this.getRandomInt(0, this.limitUI06-1);}\r\n    private randomUI08() { return this.getRandomInt(0, this.limitUI08-1) }\r\n    private randomUI12() { return this.getRandomInt(0, this.limitUI12-1) }\r\n    private randomUI14() { return this.getRandomInt(0, this.limitUI14-1) }\r\n    private randomUI16() { return this.getRandomInt(0, this.limitUI16-1) }\r\n    private randomUI32() { return this.getRandomInt(0, this.limitUI32-1) }\r\n    private randomUI40() { return (0 | Math.random() * (1 << 30)) + (0 | Math.random() * (1 << 40 - 30)) * (1 << 30) }\r\n    private randomUI48() { return (0 | Math.random() * (1 << 30)) + (0 | Math.random() * (1 << 48 - 30)) * (1 << 30) }\r\n\r\n    private create() {\r\n        this.fromParts(\r\n            this.randomUI32(),\r\n            this.randomUI16(),\r\n            0x4000 | this.randomUI12(),\r\n            0x80   | this.randomUI06(),\r\n            this.randomUI08(),\r\n            this.randomUI48()\r\n        );\r\n    };\r\n\r\n    private paddedString(string, length, z=null) {\r\n        string = String(string);\r\n        z = (!z) ? '0' : z;\r\n        let i = length - string.length;\r\n        for (; i > 0; i >>>= 1, z += z) {\r\n            if (i & 1) {\r\n            string = z + string;\r\n            }\r\n        }\r\n        return string;\r\n    };\r\n\r\n    private fromParts(timeLow, timeMid, timeHiAndVersion, clockSeqHiAndReserved, clockSeqLow, node) {\r\n        this.version = (timeHiAndVersion >> 12) & 0xF;\r\n        this.hex = this.paddedString(timeLow.toString(16), 8)\r\n            + '-'\r\n            + this.paddedString(timeMid.toString(16), 4)\r\n            + '-'\r\n            + this.paddedString(timeHiAndVersion.toString(16), 4)\r\n            + '-'\r\n            + this.paddedString(clockSeqHiAndReserved.toString(16), 2)\r\n            + this.paddedString(clockSeqLow.toString(16), 2)\r\n            + '-'\r\n            + this.paddedString(node.toString(16), 12);\r\n        return this;\r\n    };    \r\n\r\n};","import { UUID } from './uuid';\r\n\r\n// ** Path utilities\r\nexport class Path {\r\n\r\n    // ** transform dot notation to slash\r\n    static dotToSlash(path:string):string {\r\n        let p= path.split('?');\r\n        if(p[0].indexOf('.')!=-1) { \r\n            p[0]= p[0].split('.').join('/');\r\n        }\r\n        return p.join('?');\r\n    }\r\n\r\n    // ** parse context to valid Signal K path\r\n    static contextToPath(context:string):string {\r\n        let res= (context=='self' ) ? 'vessels.self': context;\r\n        return res.split('.').join('/');\r\n    }    \r\n\r\n}\r\n\r\n// ** Message templates **\r\nexport class Message {\r\n   \r\n    // ** return UPDATES message object\r\n    static updates() { \r\n        // array values= { values: [ {path: xx, value: xx } ] }\r\n        return { \r\n            context: null,\r\n            updates: [] \r\n        }\r\n    }\r\n    // ** return SUBSCRIBE message object\r\n    static subscribe() { \r\n        /* array values= {\r\n            \"path\": \"path.to.key\",\r\n            \"period\": 1000,\r\n            \"format\": \"delta\",\r\n            \"policy\": \"ideal\",\r\n            \"minPeriod\": 200\r\n            } */\r\n        return { \r\n            context: null,\r\n            subscribe: [] \r\n        }\r\n    }    \r\n    // ** return UNSUBSCRIBE message object\r\n    static unsubscribe() { \r\n        // array values= { \"path\": \"path.to.key\" }\r\n        return { \r\n            context: null,\r\n            unsubscribe: [] \r\n        }\r\n    }  \r\n    // ** return REQUEST message object\r\n    static request() { \r\n        return { \r\n            requestId: new UUID().toString()\r\n        }\r\n    }           \r\n\r\n}\r\n\r\n// ** Alarm message **\r\nexport class Alarm {\r\n\r\n    private _state:AlarmState;\r\n    private _method:Array<AlarmMethod>= [];\r\n    private _message:string='';\r\n\r\n    constructor(message:string, state?:AlarmState, visual?:boolean, sound?:boolean) {\r\n        this._message= (typeof message!== 'undefined') ? message : '';\r\n        this._state= (typeof state!== 'undefined') ? state : AlarmState.alarm;\r\n        if(visual) { this._method.push(AlarmMethod.visual)};\r\n        if(sound) { this._method.push(AlarmMethod.sound)};\r\n    }\r\n\r\n    get value() {\r\n        return {\r\n            message: this._message,\r\n            state: this._state,\r\n            method: this._method\r\n        }\r\n    }  \r\n}\r\n\r\nexport enum AlarmState {\r\n    normal= 'normal',\r\n    alert= 'alert',\r\n    warn= 'warn',\r\n    alarm= 'alarm',\r\n    emergency= 'emergency'\r\n};\r\n\r\nexport enum AlarmMethod {\r\n    visual= 'visual',\r\n    sound= 'sound'\r\n};\r\n\r\nexport enum AlarmType {\r\n    mob= 'notifications.mob',\r\n    fire= 'notifications.fire',\r\n    sinking= 'notifications.sinking',\r\n    flooding= 'notifications.flooding',\r\n    collision= 'notifications.collision',\r\n    grounding= 'notifications.grounding',\r\n    listing= 'notifications.listing',\r\n    adrift= 'notifications.adrift',\r\n    piracy= 'notifications.piracy',\r\n    abandon= 'notifications.abandon'\r\n}\r\n\r\n","import { Injectable } from '@angular/core';\r\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\r\nimport { Path } from './utils';\r\n\r\n@Injectable({ providedIn: 'root' })\r\nexport class SignalKHttp {\r\n\r\n    private _token: string;\r\n\r\n    // **************** ATTRIBUTES ***************************\r\n    public server: any;\r\n    public endpoint: string;\r\n    // ** set auth token value **\r\n    set authToken(val:string) { this._token= val }    \r\n\r\n    // *******************************************************\r\n\r\n    constructor( private http: HttpClient ) { }   \r\n    \r\n    // ** get the contents of the Signal K tree pointed to by self. returns: Observable \r\n    getSelf() { return this.get(`vessels/self`) }\r\n\r\n    //** get ID of vessel self via http. returns: Observable \r\n    getSelfId() { return this.get(`self`) }\r\n\r\n    // ** return observable response for meta object at the specified context and path\r\n    getMeta(context:string, path:string) { \r\n        return this.get(`${Path.contextToPath(context)}/${Path.dotToSlash(path)}/meta`);\r\n    }    \r\n\r\n    //** get API path value via http. returns: Observable \r\n    get(path:string) { \r\n        if(!this.endpoint) { return }\r\n        if(path[0]=='/') { path= path.slice(1) }\r\n        let url= this.endpoint + Path.dotToSlash(path);\r\n        if(this._token) {\r\n            let headers= new HttpHeaders( { 'Authorization': `JWT ${this._token}` } );\r\n            return this.http.get( url, { headers: headers } );\r\n        }\r\n        else { return this.http.get(url) }\r\n    }\r\n\r\n    //** send value to API path via http PUT. returns: Observable \r\n    put(path:string, value:any);\r\n\tput(context:string, path:string, value:any);\r\n    put(context:string, path:string, key:any, value:any);\r\n    put(c:string, p:any, k?:any, v?:any) { \r\n        if(!this.endpoint) { return }\r\n        let context:string;\r\n        let path:string;\r\n        let msg = { value: {} } \r\n        // ** path / value\r\n        if(typeof k=='undefined' && typeof v=='undefined') {\r\n            if(c[0]=='/') { c= c.slice(1) }\r\n            path= Path.dotToSlash(c);\r\n            context= '';\r\n            msg.value= p;\r\n        }\r\n        // ** context / path / value\r\n        else if(typeof v=='undefined') { \r\n            context= (c) ? Path.contextToPath(c) : '';\r\n            path=Path.dotToSlash(p);\r\n            msg.value= k;\r\n        }\r\n        else {  // ** context / path / key / value\r\n            context= (c) ? Path.contextToPath(c) : '';\r\n            let t= Path.dotToSlash(p).split('/');\r\n            t.push(k);\r\n            path= t.join('/');\r\n            msg.value= v;\r\n        }\r\n        if(path[0]=='/') { path= path.slice(1) }\r\n        \r\n        // ** patch for node server PUT handling of resources\r\n        let r= path.split('/');\r\n        if(r[0]=='resources') { \r\n            context= '';  \r\n            if(this.server && this.server.id=='signalk-server-node') { // ** check for node server\r\n                //let ver= this.server.info['version'].split('.');\r\n                //if(ver[1]<100) { // detect older versions\r\n                    // ** re-format value { uuid: { <resource_data> }}\r\n                    let v= JSON.parse(JSON.stringify(msg.value));\r\n                    msg.value= {}\r\n                    msg.value[r[r.length-1]]=v;\r\n                    // ** add self context and remove uuid from path\r\n                    path= 'vessels/self/' + r.slice(0, r.length-1).join('/');\r\n                //}\r\n            }\r\n        }\r\n        // ****************************************\r\n\r\n        context= (context) ? context + '/' : '';\r\n        let url= this.endpoint + context + Path.dotToSlash(path);\r\n        if(this._token) {\r\n            let headers= new HttpHeaders( { 'Authorization': `JWT ${this._token}` } );\r\n            return this.http.put(url, msg, { headers: headers } );\r\n        }        \r\n        else { return this.http.put(url, msg) }\r\n    } \r\n\r\n    //** send value to API path via http POST. returns: Observable \r\n    post(path:string, value:any) { \r\n        if(!this.endpoint) { return }\r\n        if(path[0]=='/') { path= path.slice(1) }\r\n        let url= `${this.endpoint}${Path.dotToSlash(path)}`;\r\n        if(this._token) {\r\n            let headers= new HttpHeaders( { 'Authorization': `JWT ${this._token}` } );\r\n            return this.http.post(url, value, { headers: headers } );\r\n        }        \r\n        else { return this.http.post(url, value) }\r\n    }     \r\n\r\n    //** delete value from API path via http DELETE. returns: Observable \r\n    delete(path:string) { \r\n        if(!this.endpoint) { return }\r\n        if(path[0]=='/') { path= path.slice(1) }\r\n        let url= `${this.endpoint}${Path.dotToSlash(path)}`;\r\n        if(this._token) {\r\n            let headers= new HttpHeaders( { 'Authorization': `JWT ${this._token}` } );\r\n            return this.http.delete(url, { headers: headers } );\r\n        }        \r\n        else { return this.http.delete(url) }\r\n    }\r\n\r\n} ","import { Injectable } from '@angular/core';\r\nimport { Subject, Observable } from 'rxjs';\r\nimport { Message, Alarm, AlarmType } from './utils';\r\n\r\n@Injectable({ providedIn: 'root' })\r\nexport class SignalKStream {\r\n\r\n\tprivate _connect: Subject<any>;\r\n    private _close: Subject<any>;\r\n\tprivate _error: Subject<any>;\r\n    private _message: Subject<any>;\r\n\r\n    private ws: any;    \r\n    private _filter= null;               // ** id of vessel to filter delta messages\r\n    private _wsTimeout= 20000;           // ** websocket connection timeout  \r\n    private _token: string;  \r\n    private _playbackMode: boolean= false;\r\n    \r\n   // **************** ATTRIBUTES ***************************\r\n\r\n    public onConnect: Observable<any>;\t\t\r\n    public onClose: Observable<any>;\t\r\n    public onError: Observable<any>; \t\r\n    public onMessage: Observable<any>;\r\n\r\n    public endpoint: string;\r\n    public selfId: string;\r\n    public _source: any= null;\r\n\r\n    // ** set source label for use in messages\r\n    set source(val:string) { \r\n        if(!this._source) { this._source= {} }\r\n        this._source['label']= val;\r\n    }\r\n\r\n    // ** set auth token value **\r\n    set authToken(val:string) { this._token= val }    \r\n    // ** get / set websocket connection timeout 3000<=timeout<=60000 **\r\n    get connectionTimeout():number { return this._wsTimeout }\r\n    set connectionTimeout(val:number) {\r\n        this._wsTimeout= (val<3000) ? 3000 : (val>60000) ? 60000 : val;\r\n    }   \r\n    // ** is WS Stream connected?\r\n    get isOpen():boolean { \r\n        return (this.ws && (this.ws.readyState!=1 && this.ws.readyState!=3) ) ? true : false;\r\n    }  \r\n    // ** get / set filter to select delta messages just for supplied vessel id   \r\n    get filter():string { return this._filter }\r\n    // ** set filter= null to remove message filtering\r\n    set filter(id:string) { \r\n        if( id && id.indexOf('self')!=-1 ) {  // ** self\r\n            this._filter= (this.selfId) ? this.selfId : null;\r\n        }\r\n        else { this._filter= id }\r\n    }   \r\n    // ** returns true if Playback Hello message\r\n    get playbackMode():boolean { return this._playbackMode }\r\n\r\n    // ******************************************************\r\n\r\n    constructor( ) { \r\n        this._connect= new Subject<any>();\r\n        this.onConnect= this._connect.asObservable();   \r\n        this._close= new Subject<any>();\r\n        this.onClose= this._close.asObservable();  \r\n        this._error= new Subject<any>();\r\n        this.onError= this._error.asObservable();  \r\n        this._message= new Subject<any>();\r\n        this.onMessage= this._message.asObservable();         \r\n    }   \r\n\r\n    // ** Close WebSocket connection\r\n    close() { if(this.ws) { this.ws.close(); this.ws= null; } }\r\n   \r\n\t// ** Open a WebSocket at provided url\r\n\topen(url:string, subscribe?:string, token?:string) {\r\n        url= (url) ? url : this.endpoint;\r\n        if(!url) { return }\r\n        let q= (url.indexOf('?')==-1) ? '?' : '&'\r\n        if(subscribe) { url+=`${q}subscribe=${subscribe}` } \r\n        if(this._token || token) { url+= `${(subscribe) ? '&' : '?'}token=${this._token || token}` } \r\n        \r\n        this.close();\r\n        this.ws = new WebSocket(url);\r\n        // ** start connection watchdog **\r\n        setTimeout( \r\n            ()=>{\r\n                if(this.ws && (this.ws.readyState!=1 && this.ws.readyState!=3) ) { \r\n                    console.warn(`Connection watchdog expired (${this._wsTimeout/1000} sec): ${this.ws.readyState}... aborting connection...`);\r\n                    this.close(); \r\n                }\r\n            }, this._wsTimeout\r\n        );\r\n\t\t\r\n\t\tthis.ws.onopen= e=> { this._connect.next(e) }\r\n\t\tthis.ws.onclose= e=> { this._close.next(e) }\r\n\t\tthis.ws.onerror= e=> { this._error.next(e) }\r\n\t\tthis.ws.onmessage= e=> {this.parseOnMessage(e) }\r\n    }  \r\n    \r\n    // ** parse received message\r\n    private parseOnMessage(e) {\r\n        let data: any;\r\n        if(typeof e.data === 'string') {\r\n            try { data= JSON.parse(e.data) }\r\n            catch(e) { return }\r\n        }\r\n        if(this.isHello(data)) { \r\n            this.selfId= data.self;\r\n            this._playbackMode= (typeof data.startTime!= 'undefined') ? true : false;                 \r\n            this._message.next(data);\r\n        }      \r\n        else if(this.isResponse(data)) { \r\n            if(typeof data.login !== 'undefined') {\r\n                if(typeof data.login.token !== 'undefined') { this._token= data.login.token }\r\n            }                \r\n            this._message.next(data);\r\n        }             \r\n        else if(this._filter && this.isDelta(data)) {\r\n            if(data.context== this._filter) { this._message.next(data) } \r\n        }                \r\n        else { this._message.next(data) } \r\n    }\r\n\r\n    // ** send request via Delta stream\r\n    sendRequest(value:any):string {\r\n        if(typeof value !== 'object') { return null }\r\n        let msg= Message.request();\r\n        if(typeof value.login === 'undefined' && this._token) { msg['token']= this._token }\r\n        let keys= Object.keys(value);\r\n        keys.forEach( k=> { msg[k]= value[k] });\r\n        this.send(msg);\r\n        return msg.requestId;\r\n    }\r\n\r\n    // ** send put request via Delta stream\r\n    put(context:string, path:string, value:any):string {\r\n        let msg= {\r\n            context: (context=='self') ? 'vessels.self' : context,\r\n            put: { path: path, value: value }\r\n        };\r\n        return this.sendRequest(msg);\r\n    }    \r\n\r\n    // ** get auth token for supplied user details **\r\n    login(username:string, password:string) {\r\n        let msg= { \r\n            login: { \"username\": username, \"password\": password } \r\n        };\r\n        return this.sendRequest(msg);\r\n    }\r\n\r\n    // ** send data to Signal K stream\r\n    send(data:any) {\r\n        if(this.ws) {\r\n            if(typeof data === 'object') { data= JSON.stringify(data) }\r\n            this.ws.send(data);\r\n        }\r\n    }\r\n\r\n    // ** send value(s) via delta stream update **\r\n    sendUpdate(context:string, path:Array<any>);\r\n    sendUpdate(context:string, path:string, value:any);\r\n    sendUpdate(context:string='self', path: string | Array<any>, value?:any) {\r\n        let val= Message.updates();\r\n        if(this._token) { val['token']= this._token }\r\n        val.context= (context=='self') ? 'vessels.self' : context;\r\n        if(this._token) { val['token']= this._token }\r\n\r\n        let uValues= [];\r\n        if(typeof path === 'string') {\r\n            uValues.push({ path: path, value: value });\r\n        }\r\n        if(typeof path === 'object' && Array.isArray(path) ) {\r\n            uValues= path;\r\n        }\r\n        let u= { \r\n            timestamp: new Date().toISOString(), \r\n            values: uValues \r\n        }\r\n        if(this._source) { u['source']= this._source }\r\n        val.updates.push( u ); \r\n        this.send(val);\r\n    }\r\n\r\n    // ** Subscribe to Delta stream messages options: {..}**\r\n    subscribe(context:string, path:Array<any>);\r\n    subscribe(context:string, path:string, options?:any);\r\n    subscribe(context:string='*', path:string | Array<any>='*', options?:any) {\r\n        let val= Message.subscribe();\r\n        if(this._token) { val['token']= this._token }\r\n        val.context= (context=='self') ? 'vessels.self' : context;\r\n        if(this._token) { val['token']= this._token }\r\n\r\n        if(typeof path === 'object' && Array.isArray(path) ) {\r\n           val.subscribe= path;\r\n        }\r\n        if(typeof path === 'string') {\r\n            let sValue= {};\r\n            sValue['path']= path;\r\n            if(options && typeof options === 'object') {\r\n                if(options['period']) { sValue['period']= options['period'] }\r\n                if(options['minPeriod']) { sValue['minPeriod']= options['period'] }\r\n                if(options['format'] && \r\n                    (options['format']=='delta' || options['format']=='full') ) { \r\n                        sValue['format']= options['format'];\r\n                }\r\n                if(options['policy'] && \r\n                    (options['policy']=='instant' || options['policy']=='ideal'\r\n                    || options['policy']=='fixed') ) { \r\n                        sValue['policy']= options['policy'];\r\n                }\r\n            }\r\n            val.subscribe.push(sValue);\r\n        }\r\n        this.send(val);        \r\n    }\r\n\r\n    // ** Unsubscribe from Delta stream messages **\r\n    unsubscribe(context:string='*', path:any='*') {\r\n        let val= Message.unsubscribe();\r\n        if(this._token) { val['token']= this._token }\r\n        val.context= (context=='self') ? 'vessels.self' : context;\r\n        if(this._token) { val['token']= this._token }\r\n\r\n        if(typeof path === 'object' && Array.isArray(path) ) {\r\n           val.unsubscribe= path;\r\n        }\r\n        if(typeof path === 'string') { val.unsubscribe.push({path: path}) }\r\n        this.send(val); \r\n    }\r\n\r\n    // ** raise alarm for path\r\n    raiseAlarm(context:string, name:string, alarm:Alarm);\r\n    raiseAlarm(context:string, type:AlarmType, alarm:Alarm);\r\n    raiseAlarm(context:string='*', alarmId:any, alarm:Alarm) {\r\n        let n:string;\r\n        if(typeof alarmId === 'string') {\r\n            n=(alarmId.indexOf('notifications.')==-1) ? `notifications.${alarmId}` : alarmId;\r\n        }\r\n        else { n= alarmId }\r\n        this.sendUpdate(context, n, alarm.value );\r\n    }\r\n\r\n    // ** raise alarm for path\r\n    clearAlarm(context:string='*', name:string) {\r\n        let n=(name.indexOf('notifications.')==-1) ? `notifications.${name}` : name;\r\n        this.sendUpdate(context, n, null);\r\n    }    \r\n\r\n    // *************** MESSAGE PARSING ******************************\r\n    // ** returns true if message context is 'self'\r\n    isSelf(msg:any):boolean { return (msg.context== this.selfId) }\r\n    // ** returns true if message is a Delta message\r\n    isDelta(msg:any):boolean { return typeof msg.context!= 'undefined' }\r\n    // ** returns true if message is a Hello message\r\n    isHello(msg:any):boolean { \r\n        return (typeof msg.version!= 'undefined' && typeof msg.self!= 'undefined');\r\n    }     \r\n    // ** returns true if message is a request Response message\r\n    isResponse(msg:any):boolean { return typeof msg.requestId!= 'undefined' } \r\n}","/** Signal K server Apps\r\n * ************************************/\r\nimport { Injectable } from '@angular/core';\r\nimport { HttpClient } from '@angular/common/http';\r\n\r\n@Injectable({ providedIn: 'root' })\r\nexport class SignalKApps  {\r\n\r\n   // **************** ATTRIBUTES ***************************\r\n\t\r\n    // ** apps api endpoint path\r\n    public endpoint: string;\r\n\r\n   // *******************************************************    \r\n\r\n    constructor(private http: HttpClient) { } \r\n\r\n    ngOnDestroy() { }\r\n    \r\n    // ** return List of installed apps\r\n    list() { \r\n        let ep= (this.endpoint.indexOf('webapps')==-1) ?\r\n            `${this.endpoint}list` : this.endpoint;\r\n        return this.http.get(ep);\r\n    }\r\n    \r\n}","import { Injectable, isDevMode } from '@angular/core';\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { Subject, Observable, of } from 'rxjs';\n\nimport { SignalKHttp } from './http-api';\nimport { SignalKStream } from './stream-api';\nimport { SignalKApps } from './apps-api';\nimport { Path, Message } from './utils';\nimport { UUID } from './uuid';\n\ninterface Server_Info {\n    endpoints: any;\n    info: any,\n    apiVersions: Array<any>;\n}\n\ninterface JSON_Patch {\n    op: 'add' | 'replace' | 'remove' | 'copy' | 'move' | 'test';\n    path: string;\n    value: any;\n}\n\nexport enum APPDATA_CONTEXT {\n    USER= 'user',\n    GLOBAL= 'global'\n}\n\n@Injectable({ providedIn: 'root' })\nexport class SignalKClient {\n    \n    private hostname: string;\n    private port: number;\n    private protocol: string;\n  \n    private _version: string= 'v1';      // ** default Signal K api version\n    private _token: string;             // token for when security is enabled on the server\n\n    private debug(val: any) { if(isDevMode()){ console.log(val) } }\n\n    // ** endpoints to fallback to if hello response is not received.\n    private fallbackEndpoints= {\n        endpoints: { v1: { } },\n        server: { id : \"fallback\" }\n    };    \n\n    // **************** ATTRIBUTES ***************************  \n\n    // ** server information block **\n    public server: Server_Info= {\n        endpoints: {},\n        info: {},\n        apiVersions: []\n    }  \n\n    // ** endpoints fallback to host address when no hello response\n    public fallback:boolean= false;\n\n    // ** get / set Signal K preferred api version to use **\n    get version():number { return parseInt( this._version.slice(1) ) }\n    set version(val: number) {\n        let v:string= 'v'+ val;\n        if(this.server.apiVersions.length==0) { \n            this._version= v;\n            this.debug(`Signal K api version set to: ${v}`);\n        }\n        else {\n            this._version= (this.server.apiVersions.indexOf(v)!=-1) ? v : this._version;\n            this.debug(`Signal K api version set request: ${v}, result: ${this._version}`);\n        }\n    }\n    // ** set auth token value **\n    set authToken(val:string) { \n        this._token= val;\n        this.api.authToken= val;\n        this.stream.authToken= val;\n    }    \n    // ** Message Object\n    get message() { return Message }\n\n    // ** generate and return a UUID object\n    get uuid():UUID { return new UUID() }\n\n    // *******************************************************\n    constructor( private http: HttpClient, \n                public apps: SignalKApps,\n                public api: SignalKHttp, \n                public stream: SignalKStream ) { \n        this.init();                          \n    }\n\n    ngOnDestroy() { this.stream.close() }   \n    \n    // ** initialise protocol, hostname, port values\n    private init(hostname:string='localhost', port:number=null, useSSL:boolean=false) {\n        this.hostname = hostname;\n        if(useSSL) {\n            this.protocol = 'https';\n            this.port = port || 443;\n        } \n        else {\n            this.protocol = 'http';\n            this.port = port || 80;\n        }   \n        let url= `${this.protocol}://${this.hostname}:${this.port}`;  \n        this.fallbackEndpoints.endpoints.v1['signalk-http']= `${url}/signalk/v1/api/`;\n        this.fallbackEndpoints.endpoints.v1['signalk-ws']= `${url}/signalk/v1/stream`;\n    }    \n\n    // **************** CONNECTION AND DISCOVERY  ********************\n\n    // ** Signal K server endpoint discovery request (/signalk).  \n    hello(hostname:string=null, port:number=null, useSSL:boolean=false) {\n        this.init(hostname, port, useSSL);\n        return this.get('/signalk');\n    }    \n\n\n    // ** connect to server (endpoint discovery) and DO NOT open Stream\n    connectAsPromise(hostname:string=null, port:number=null, useSSL:boolean=false):Promise<any> {\n        return new Promise( (resolve, reject)=> {\n            this.debug('Contacting Signal K server.........');\n            this.hello(hostname, port, useSSL).subscribe(    // ** discover endpoints **\n                response=> { \n                    this.getLoginStatus().subscribe( r=>{} );\n                    if(this.stream) { this.stream.close() }\n                    this.processHello(response);\n                    this.api.endpoint= this.resolveHttpEndpoint();\n                    this.stream.endpoint= this.resolveStreamEndpoint();\n                    resolve(true);\n                },\n                error=> { \n                    if(this.fallback) { // fallback if no hello response\n                        if(this.stream) { this.stream.close() }\n                        this.processHello(null);\n                        this.api.endpoint= this.resolveHttpEndpoint();\n                        this.stream.endpoint= this.resolveStreamEndpoint();\n                        resolve(true);                   \n                    }\n                    else {\n                        this.disconnectedFromServer();       \n                        reject(error);\n                    }\n                }\n            );\n        });\n    }    \n\n    // ** connect to server (endpoint discovery) and DO NOT open Stream\n    connect(hostname:string=null, port:number=null, useSSL:boolean=false):Observable<any> {\n        let sub: Subject<any>= new Subject();\n        this.debug('Contacting Signal K server.........');\n        this.hello(hostname, port, useSSL).subscribe(    // ** discover endpoints **\n            response=> { \n                this.getLoginStatus().subscribe( r=>{} );\n                if(this.stream) { this.stream.close() }\n                this.processHello(response);\n                this.api.endpoint= this.resolveHttpEndpoint();\n                this.stream.endpoint= this.resolveStreamEndpoint();\n                sub.next(true);\n            },\n            error=> { \n                if(this.fallback) { // fallback if no hello response\n                    if(this.stream) { this.stream.close() }\n                    this.processHello(null);\n                    this.api.endpoint= this.resolveHttpEndpoint();\n                    this.stream.endpoint= this.resolveStreamEndpoint();\n                    sub.next(true);                    \n                }\n                else {\n                    this.disconnectedFromServer();       \n                    sub.error(error);\n                }\n            }\n        );\n        return sub.asObservable();\n    }  \n\n    // ** disconnect from server\n    disconnect() { this.stream.close()} \n    \n    // ** Connect + open Delta Stream (endpoint discovery)\n    connectStreamAsPromise(hostname:string=null, port:number=null, useSSL:boolean=false, subscribe:string=null):Promise<any> {\n        return new Promise( (resolve, reject)=> {\n            this.connectAsPromise(hostname, port, useSSL)\n            .then( ()=> { \n                // ** connect to stream api at preferred version else fall back to default version\n                let url= this.resolveStreamEndpoint();\n                if(!url) { \n                    reject( new Error('Server has no advertised Stream endpoints!') );\n                    return;\n                }\n                this.stream.open(url, subscribe);\n                resolve( true );\n            })\n            .catch( e=> { reject( e ) });\n        });\n    } \n\n    // ** Connect + open Delta Stream (endpoint discovery)\n    connectStream(hostname:string=null, port:number=null, useSSL:boolean=false, subscribe:string=null):Observable<any> {\n        let sub: Subject<any>= new Subject();\n        this.connect(hostname, port, useSSL).subscribe( \n            ()=> { \n                // ** connect to stream api at preferred version else fall back to default version\n                let url= this.resolveStreamEndpoint();\n                if(!url) { \n                    sub.error( new Error('Server has no advertised Stream endpoints!') );\n                    return;\n                }\n                this.stream.open(url, subscribe);\n                sub.next( true );\n            },\n            e=> { sub.error( e ) }\n        );\n        return sub.asObservable();\n    }\n\n    // ** connect to playback stream (endpoint discovery)\n    connectPlaybackAsPromise(hostname:string=null, port:number=null, useSSL:boolean=false, options:any):Promise<any> {\n        return new Promise( (resolve, reject)=> {\n            this.connectAsPromise(hostname, port, useSSL)\n            .then( ()=> { \n                // ** connect to playback api at preferred version else fall back to default version\n                this.openPlayback(null, options, this._token);\n                resolve( true );\n            })\n            .catch( e=> { reject( e ) });\n        })\n    }\n\n    // ** connect to playback stream (endpoint discovery)\n    connectPlayback(hostname:string=null, port:number=null, useSSL:boolean=false, options:any):Observable<any> {\n        let sub: Subject<any>= new Subject();\n        this.connect(hostname, port, useSSL).subscribe( \n            ()=> { \n                // ** connect to playback api at preferred version else fall back to default version\n                this.openPlayback(null, options, this._token);\n                sub.next( true );\n            },\n            e=> { sub.error( e ) }\n        );\n        return sub.asObservable();\n    }      \n\n    // ** connect to delta stream with (NO endpoint discovery)\n    openStream(url:string=null, subscribe?:string, token?:string) {\n        this.debug('openStream.........');  \n        if(!url) {     // connect to stream api at discovered endpoint\n            url= this.resolveStreamEndpoint();\n            if(!url) { \n                return( new Error('Server has no advertised Stream endpoints!') );\n            }\n        }\n        this.stream.open(url, subscribe, token);  \n        return true;      \n    }   \n\n    // ** connect to playback stream (NO endpoint discovery)\n    openPlayback(url:string=null, options?:any, token?:string) {\n        this.debug('openPlayback.........');\n        if(!url) {     // connect to stream api at discovered endpoint\n            url= this.resolveStreamEndpoint();\n            if(!url) { \n                return( new Error('Server has no advertised Stream endpoints!') );\n            }\n            url= url.replace('stream', 'playback');\n        }        \n        let pb= '';\n        let subscribe: string;\n        if(options && typeof options ==='object'){\n            pb+= (options.startTime) ? '?startTime=' + options.startTime.slice(0,options.startTime.indexOf('.')) + 'Z' : '';\n            pb+= (options.playbackRate) ? `&playbackRate=${options.playbackRate}` : '';\n            subscribe= (options.subscribe) ? options.subscribe : null;            \n        }\n        this.stream.open(url + pb, subscribe, token); \n        return true;\n    }      \n\n    // ** process Hello response \n    private processHello(response: any) {\n        this.server.endpoints= (response && response['endpoints']) ? \n            response['endpoints'] : this.fallbackEndpoints.endpoints;\n        this.server.info= (response && response['server']) ? \n            response['server'] : this.fallbackEndpoints.server;\n        this.server.apiVersions= (this.server.endpoints) ? Object.keys(this.server.endpoints) : [];\n        this.debug(this.server.endpoints);\n        this.api.server= this.server.info;\n        this.apps.endpoint= this.resolveAppsEndpoint();\n    }\n\n    // ** return signalk apps api url\n    private resolveAppsEndpoint():string {      \n        let url:string= this.resolveHttpEndpoint().replace('api','apps');  \n        if(this.server && this.server.info.id=='signalk-server-node') { \n            let ver= this.server.info['version'].split('.');\n            if(ver[1]<26) { //use legacy link for older versions\n                url= `${this.protocol}://${this.hostname}:${this.port}/webapps`;\n            }\n        }\n        return url;\n    } \n\n    // ** return preferred WS stream url\n    public resolveStreamEndpoint():string {\n        if(this.server.endpoints[this._version] && this.server.endpoints[this._version]['signalk-ws']) {\n            this.debug(`Connecting endpoint version: ${this._version}`);\n            return `${this.server.endpoints[this._version]['signalk-ws']}`;\n        }\n        else if(this.server.endpoints['v1'] && this.server.endpoints['v1']['signalk-ws']) { \n            this.debug(`Connection falling back to: v1`);\n            return `${this.server.endpoints['v1']['signalk-ws']}` \n        }\n        else { return null }\n    }  \n\n    // ** return signalk-http endpoint url\n    private resolveHttpEndpoint():string {\n        let url: string;\n        if(this.server.endpoints[this._version]) { // ** connection made\n            // ** connect to http endpoint at prescribed version else fall back to default version\n            if(this.server.endpoints[this._version]['signalk-http']) {\n                url= `${this.server.endpoints[this._version]['signalk-http']}`;\n            }\n            else { url= `${this.server.endpoints['v1']['signalk-http']}` }   \n        } \n        else {\n            let msg= 'No current connection http endpoint service! Use connect() to establish a connection.'\n            this.debug(msg);\n        } \n        return url;   \n    }    \n    \n    // ** cleanup on server disconnection\n    private disconnectedFromServer() {\n        this.server.endpoints= {};\n        this.server.info= {};\n        this.server.apiVersions= [];  \n    }\n\n    //** return observable response from http path\n    get(path:string) { \n        if(path && path.length>0 && path[0]=='/') { path= path.slice(1) }\n        let url= `${this.protocol}://${this.hostname}:${this.port}/${Path.dotToSlash(path)}`;\n        this.debug(`get ${url}`);\n        if(this._token) {\n            let headers= new HttpHeaders( { 'Authorization': `JWT ${this._token}` } );\n            return this.http.get( url, { headers: headers } );\n        }\n        else { return this.http.get(url) }        \n    };  \n\n    //** return observable response for put to http path\n    put(path:string, value:any) { \n        let url= `${this.protocol}://${this.hostname}:${this.port}/${Path.dotToSlash(path)}`;\n        this.debug(`put ${url}`);\n        if(this._token) {\n            let headers= new HttpHeaders( { 'Authorization': `JWT ${this._token}` } );\n            return this.http.put( url, value, { headers: headers } );\n        }\n        else { return this.http.put(url, value) }        \n    };\n\n    //** return observable response for post to http path\n    post(path:string, value:any) { \n        if(path && path.length>0 && path[0]=='/') { path= path.slice(1) }\n        let url= `${this.protocol}://${this.hostname}:${this.port}/${Path.dotToSlash(path)}`;\n        this.debug(`post ${url}`);\n        if(this._token) {\n            let headers= new HttpHeaders( { 'Authorization': `JWT ${this._token}` } );\n            return this.http.post( url, value, { headers: headers } );\n        }\n        else { return this.http.post(url, value) }        \n    };   \n\n    // ** get auth token for supplied user details **\n    login(username:string, password:string) {\n        let headers= new HttpHeaders().set('Content-Type', `application/json`);\n        return this.http.post(\n            `${this.protocol}://${this.hostname}:${this.port}/signalk/${this._version}/auth/login`,\n            { \"username\": username, \"password\": password },\n            { headers }\n        );\n    }\n\t\n    // ** logout from server **\n    logout():Observable<boolean> { \n        let sub: Subject<boolean>= new Subject();;\n\t\tlet url=`${this.protocol}://${this.hostname}:${this.port}/signalk/${this._version}/auth/logout`;\n        if(this._token) {\n            let headers= new HttpHeaders( { 'Authorization': `JWT ${this._token}`} );\n            this.http.put( url, null, { headers: headers, responseType: 'text' } ).subscribe(\n                ()=> { sub.next(true) },\n                ()=> { sub.next(false) }\n            );\n        }        \n        else { \n            this.http.put( url, null, {responseType: 'text'} ).subscribe(\n                ()=> { sub.next(true) },\n                ()=> { sub.next(false) }\n            );\n        }\n        return sub.asObservable();\n    }\t  \n    \n    // ** is a user authenticated to the server **\n    isLoggedIn():Observable<boolean> {\n        let sub: Subject<boolean>= new Subject();    \n        this.getLoginStatus().subscribe(\n            r=> { sub.next( r.status=='loggedIn' ? true : false ) },\n            ()=> { sub.next(false) } \n        );\n        return sub.asObservable();\n    }\n    // ** fetch login status from server **\n    getLoginStatus():Observable<any> { return this.get('/loginstatus') }    \n    \n    //** get data via the snapshot http api path for supplied time\n    snapshot(context:string, time:string) { \n        if(!time) { return }\n        time= time.slice(0,time.indexOf('.')) + 'Z';\n        let url= this.resolveHttpEndpoint();\n        if(!url) { return }\n        url= `${url.replace('api','snapshot')}${Path.contextToPath(context)}?time=${time}`;\n        if(this._token) {\n            let headers= new HttpHeaders( { 'Authorization': `JWT ${this._token}` } );\n            return this.http.get( url, { headers: headers } );\n        }\n        else { return this.http.get(url) }\n    }\n    \n    /*******************************\n     *  applicationData api methods \n     * context: 'user' or 'global'\n     * appId: application id string\n     *******************************/\n    private _appId:string;\n    private _appVersion:string;\n\n    private resolveAppDataEndpoint(context:APPDATA_CONTEXT, appId:string) {\n        if(!context || !appId) { return null }\n        let url:string= this.resolveHttpEndpoint().replace('api','applicationData');\n        return `${url}${context}/${appId}/`;\n    }\n\n    setAppId(value:string) { this._appId= value }\n    setAppVersion(value:string) { this._appVersion= value }\n\n    // ** get list of available versions of data stored **\n    appDataVersions(context:APPDATA_CONTEXT= APPDATA_CONTEXT.USER, appId:string= this._appId) {\n        let url= this.resolveAppDataEndpoint(context, appId);\n        if(this._token) {\n            let headers= new HttpHeaders( { 'Authorization': `JWT ${this._token}` } );\n            return this.http.get( url, { headers: headers } );\n        }\n        else { return this.http.get(url) }     \n    }\n    // ** get list of available keys for a stored path **\n    appDataKeys(path:string='', context:APPDATA_CONTEXT= APPDATA_CONTEXT.USER, appId:string= this._appId, version:string= this._appVersion) {\n        path= (path.length!=0 && path[0]=='/') ? path.slice(1) : path;\n        let url= this.resolveAppDataEndpoint(context, appId);\n        url+= `${version}/${path}?keys=true`;\n        if(this._token) {\n            let headers= new HttpHeaders( { 'Authorization': `JWT ${this._token}` } );\n            return this.http.get( url, { headers: headers } );\n        }\n        else { return this.http.get(url) }     \n    }    \n\n    // ** get stored value at provided path **\n    appDataGet(path:string='', context:APPDATA_CONTEXT= APPDATA_CONTEXT.USER, appId:string= this._appId, version:string= this._appVersion) {\n        path= (path.length!=0 && path[0]=='/') ? path.slice(1) : path;\n        let url= this.resolveAppDataEndpoint(context, appId);\n        url+= `${version}/${path}`;\n        if(this._token) {\n            let headers= new HttpHeaders( { 'Authorization': `JWT ${this._token}` } );\n            return this.http.get( url, { headers: headers } );\n        }\n        else { return this.http.get(url) }     \n    }\n\n    // ** set stored value at provided path **\n    appDataSet(path:string, value:any, context:APPDATA_CONTEXT= APPDATA_CONTEXT.USER, appId:string= this._appId, version:string= this._appVersion) {\n        if(!path) { return }\n        if(path[0]=='/') { path= path.slice(1) }\n        let ep= this.resolveAppDataEndpoint(context, appId);\n        if(!ep) { return }\n        let url= `${ep}${version}/${Path.dotToSlash(path)}`;\n        if(this._token) {\n            let headers= new HttpHeaders( { 'Authorization': `JWT ${this._token}` } );\n            return this.http.post(url, value, { headers: headers } );\n        }        \n        else { return this.http.post(url, value) }\n    }    \n    \n    // ** update / patch stored values using Array of JSON patch objects **\n    appDataPatch(value:Array<JSON_Patch>, context:APPDATA_CONTEXT= APPDATA_CONTEXT.USER, appId:string= this._appId, version:string= this._appVersion) {\n        let ep= this.resolveAppDataEndpoint(context, appId);\n        if(!ep || !version ) { return }\n        let url= `${ep}${version}`;\n        if(this._token) {\n            let headers= new HttpHeaders( { 'Authorization': `JWT ${this._token}` } );\n            return this.http.post(url, value, { headers: headers } );\n        }        \n        else { return this.http.post(url, value) }\n    }    \n\n}\n","/*****************************\r\n * SignalKClient Module:\r\n *****************************/\r\n\r\nimport { NgModule } from '@angular/core';\r\nimport { HttpClientModule} from '@angular/common/http';\r\n\r\n@NgModule({\r\n    imports: [ HttpClientModule ],    \r\n    declarations: [],\r\n    exports: [],\r\n    entryComponents: [], \r\n    providers: []  \r\n})\r\nexport class SignalKClientModule {}\r\n\r\nexport * from './signalk-client';\r\nexport * from './utils';\r\nexport * from './stream-api';\r\nexport * from './http-api';\r\nexport * from './apps-api';"]}